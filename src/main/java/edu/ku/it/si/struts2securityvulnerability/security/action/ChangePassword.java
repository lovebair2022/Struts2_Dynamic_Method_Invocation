package edu.ku.it.si.struts2securityvulnerability.security.action;



import org.apache.log4j.Logger;

import com.opensymphony.xwork2.ActionSupport;

/**
 * Acts as a controller to handle actions
 * related to recovering a user's password.
 * @author bruce phillips
 *
 */
public class ChangePassword extends ActionSupport {
	
	private static final long serialVersionUID = 1L;
	
	private static final Logger logger = Logger.getLogger( ChangePassword.class.getName() );
	
	private String username ;
	
	private String currentPassword;
	
	private String newPassword;
	
	

	public String execute() throws Exception {
		
		//do work of verifying provided username and password
		
		boolean userAuthenticated = true ;
		
		if (userAuthenticated ) {
			
			changePassword();
			
			return SUCCESS;
			
		} else {
			
			
			return INPUT ;
			
		}
		
		
		
	}




    /*
     * This method should not be public
     * since it should only be called
     * from within this class.
     * If Struts 2 dynamic method invocation has
     * not been disabled then this method
     * can be called by any user of this
     * web application.
     */
	public void changePassword() {
		
		//do work of changing the user's
		//password
		logger.info("User " + username + " password was changed to " + newPassword );
		
		
	}
	

	
	

	public String getUsername() {
		return username;
	}




	public void setUsername(String username) {
		this.username = username;
	}




	public String getCurrentPassword() {
		return currentPassword;
	}




	public void setCurrentPassword(String currentPassword) {
		this.currentPassword = currentPassword;
	}




	public String getNewPassword() {
		return newPassword;
	}




	public void setNewPassword(String newPassword) {
		this.newPassword = newPassword;
	}


}
